{% extends "ckblues/layout.html" %}
{% load static %}

{% block body %}
  <h2>CK Blues: Blog</h2>

  {% for post in posts %}
    <section class="post">
      <h3><a href="{% url 'post' post.slug %}">{{ post.title }}</a></h3>
      <p>{{ post.excerpt }}</p>
    </section>
  {% endfor %}

  <h3>Filter Blog Posts:</h3>
    <ul>
      {% for category in categories %}
        <li><a href="{% url 'filterCategory' category %}">{{ category }}</a></li>
      {% empty %}
        <li><a href="{% url 'index' %}">Home</a></li>
      {% endfor %}
    </ul>

  {% if user.is_authenticated %}
  <!-- display all filtered content if logged in -->
    {% for post in allFilteredPosts %}
      <section class="post">
        <h3><a href="{% url 'post' post.slug %}">{{ post.title }}</a></h3>
        <p>{{ post.excerpt }}</p>
      </section>
    {% endfor %}
  {% else %}
    <!-- display all free filtered posts if user not logged in -->
    {% for post in freeFilteredPosts %}
      <section class="post">
        <h3><a href="{% url 'post' post.slug %}">{{ post.title }}</a></h3>
        <p>{{ post.excerpt }}</p>
      </section>
    {% endfor %}
  {% endif %}

{% endblock %}